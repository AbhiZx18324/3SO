ğŸ“œ Rule Syntax Guide

This document defines the three kinds of rules used in the anomaly detection system: Plain Rules, Relation Rules, and Time Rules.

1. âœ… Plain Rule

A Plain Rule is used to define simple threshold or pattern-based conditions.

ğŸ”¹ Syntax

NAME=<rule_name>;KEY1=VAL1;KEY2=VAL2;...;[RESET=X,Y];[INTERVAL=HH:MM:SS-HH:MM:SS];[EVENTS > X];[WITH_DETAILS];

ğŸ”¹ Keywords

NAME â€” Name of the rule.

PROCESS, FKL-PROCESS, USER â€” Keywords representing fields in the log data.

USER supports regex values like ^[JS].* to match usernames.

ğŸ”¹ Parameters

RESET=X,Y â€” Reset the rule after a period. Y can be MINUTE, HOUR, DAY, or WEEK.

INTERVAL=HH:MM:SS-HH:MM:SS â€” Time window in which the rule is valid.

EVENTS > X or EVENTS < X â€” Trigger only after more/less than X satisfactions.

WITH_DETAILS â€” Include matching log lines in the output.

ğŸ”¹ Example

NAME=Rule1;PROCESS=LOGIN;FKL-PROCESS=8,16;USER=^[JS].*;RESET=1,DAY;INTERVAL=20:30:00-07:00:00;

2. ğŸ”— Relation Rule

A Relation Rule defines a ratio between two plain rules over a time interval.

ğŸ”¹ Syntax

NAME=<rule_name>;FIRST(<plain_rule_1>)SECOND(<plain_rule_2>)RESET=X,Y;[WITH_DETAILS];

ğŸ”¹ Keywords & Parameters

FIRST(...) â€” A plain rule defining the numerator.

SECOND(...) â€” A plain rule defining the denominator.

RESET=X,Y â€” Time interval for computing the ratio (e.g., 4,HOUR).

WITH_DETAILS â€” Show all related events in output.

ğŸ”¹ Example

NAME=Relation1;FIRST(NAME=FailLogin;PROCESS=LOGIN;FKL-PROCESS=8,16;)SECOND(NAME=Login;PROCESS=LOGIN;)RESET=4,HOUR;

3. â± Time Rule

A Time Rule tracks sequences of events. If one condition (IF) happens and another condition (KEIN or THEN) does/does not happen within a time window (IN), it is marked anomalous.

ğŸ”¹ Syntax

NAME=<rule_name>;IF(<plain_rule_1>)THEN(<plain_rule_2>)IN(X;Y);[WITH_DETAILS];

ğŸ”¹ Parameters

IF(...) â€” Trigger rule based on a user event.

THEN(...) â€” Expect a matching event after IF.

IN(X,Y) â€” Time window after IF (e.g., 5;MIN means 5 minutes).

WITH_DETAILS â€” Include event trace.

EVENTS > X â€” Threshold for alerts.

ğŸ”¹ Example

NAME=Time1;IF(PROCESS=LOGIN;FKL-PROCESS=8,16;USER=^[QSJ].*)KEIN(PROCESS=LOGIN;FKL-PROCESS=0,2;USER=^[QSJ].*) IN (5;MIN);

âœ… Notes

Rules must be written in one line.

Use semicolons (;) to separate fields.

Fields and values are case-sensitive.